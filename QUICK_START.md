# Быстрый старт

## Пошаговая инструкция для первого запуска

### 1. Подготовка базы данных

Убедитесь, что MongoDB запущен:
- **Локально**: Запустите MongoDB на вашем компьютере
- **MongoDB Atlas**: Используйте строку подключения из Atlas

### 2. Настройка Backend

```bash
cd flight-connect-backend
npm install
```

Создайте файл `.env`:
```env
MONGODB_URI=mongodb://localhost:27017/flight-connect
PORT=3000
NODE_ENV=development
CORS_ORIGIN=http://localhost:8080
JWT_SECRET=change-this-to-random-secret-key-in-production
JWT_EXPIRES_IN=7d
```

### 3. Создание первого администратора

```bash
npm run create-admin
```

Это создаст администратора с данными:
- **Имя пользователя**: `admin`
- **Пароль**: `admin123`
- **Имя**: `Администратор`

Или создайте с собственными данными:
```bash
npm run create-admin myadmin mypassword123 "Мой Админ"
```

### 4. Запуск Backend

```bash
npm run dev
```

Сервер запустится на `http://localhost:3000`

### 5. Настройка Frontend

Откройте новый терминал:
```bash
cd flight-connect
npm install
```

Создайте файл `.env`:
```env
VITE_API_BASE_URL=http://localhost:3000/api
```

### 6. Запуск Frontend

```bash
npm run dev
```

Приложение откроется на `http://localhost:8080`

### 7. Первый вход

1. Откройте `http://localhost:8080` в браузере
2. **Кликните на "Аноним"** в правом верхнем углу (откроется окно входа)
3. Введите:
   - Имя пользователя: `admin`
   - Пароль: `admin123`
4. После входа нажмите **"Диспетчер"**
5. В меню пользователя нажмите **"Админ"**

### 8. Создание диспетчера

1. В панели администратора нажмите **"Создать диспетчера"**
2. Заполните форму и сохраните пароль
3. Передайте данные диспетчеру для входа

## Решение проблем

### Ошибка подключения к MongoDB

Убедитесь, что:
- MongoDB запущен локально, или
- Строка подключения к MongoDB Atlas правильная
- В `.env` указан правильный `MONGODB_URI`

### Ошибка "Администратор уже существует"

Если администратор уже создан, используйте существующие данные для входа или создайте нового с другим именем пользователя:
```bash
npm run create-admin admin2 password123 "Второй Админ"
```

### Ошибка CORS

Убедитесь, что в `.env` backend указан правильный `CORS_ORIGIN`:
```env
CORS_ORIGIN=http://localhost:8080
```

### Не могу войти как администратор

1. **Если администратор был создан до обновления скрипта** (пароль мог быть хеширован дважды):
   ```bash
   npm run fix-admin-password admin admin123
   ```
   Это обновит пароль администратора с именем пользователя "admin" на "admin123"

2. Проверьте, что администратор создан:
   - Запустите MongoDB shell или используйте MongoDB Compass
   - Проверьте коллекцию `users` - должен быть пользователь с `role: "admin"`
   
3. Попробуйте создать администратора заново с другими данными:
   ```bash
   npm run create-admin admin2 password123 "Второй Админ"
   ```

4. Проверьте логи сервера при попытке входа - там будет информация об ошибке

5. Убедитесь, что сервер запущен и доступен на `http://localhost:3000`
