# Система авторизации Flight Connect

## Роли пользователей

1. **Пилот (pilot)** - обычный пользователь, может регистрироваться на сессии
2. **Диспетчер (dispatcher)** - может создавать и управлять сессиями
3. **Администратор (admin)** - может создавать диспетчеров и удалять сессии из архива

## Создание первого администратора

### Способ 1: Через командную строку (рекомендуется)

Для создания первого администратора выполните команду:

```bash
npm run create-admin
```

Это создаст администратора с данными по умолчанию:
- **Имя пользователя**: `admin`
- **Пароль**: `admin123`
- **Имя**: `Администратор`

### Способ 2: С указанием параметров

```bash
npm run create-admin [username] [password] [name]
```

Пример:
```bash
npm run create-admin myadmin mypassword123 "Имя Администратора"
```

### Важно

⚠️ **Сохраните данные для входа в безопасном месте!**

После создания администратора:
1. Запустите backend сервер: `npm run dev`
2. Откройте frontend приложение
3. Нажмите "Войти" и используйте созданные данные
4. После входа перейдите в раздел "Админ" для создания диспетчеров

## API Endpoints

### Авторизация

- `POST /api/auth/register` - Регистрация пилота
- `POST /api/auth/login` - Вход в систему
- `GET /api/auth/me` - Получить текущего пользователя
- `POST /api/auth/dispatchers` - Создать диспетчера (только админ)
- `GET /api/auth/dispatchers` - Получить список диспетчеров (только админ)

### Защищенные маршруты

- `POST /api/sessions` - Создание сессии (диспетчер/админ)
- `PATCH /api/sessions/:id` - Обновление сессии (диспетчер/админ)
- `DELETE /api/sessions/:id` - Удаление сессии из архива (только админ)
- `PATCH /api/participants/:id` - Обновление участника (диспетчер/админ)

## Переменные окружения

Добавьте в `.env`:

```env
JWT_SECRET=your-secret-key-change-in-production
JWT_EXPIRES_IN=7d
```

## Использование токенов

Все защищенные запросы должны содержать заголовок:
```
Authorization: Bearer <token>
```

Токен сохраняется в localStorage после успешного входа или регистрации.
